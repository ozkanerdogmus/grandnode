@model CatalogPagingFilteringModel.SpecificationFilterModel
@{
    var notFilteredItemsGroups = Model.NotFilteredItems.GroupBy(x => x.SpecificationAttributeName);
}
@if (Model.Enabled)
{
    <div id="block-product-spec-filter" class="block product-filter product-spec-filter">
        <h5 class="h5">
            <span>@T("Filtering.SpecificationFilter")</span>
        </h5>
        <div class="filter-content viewBox">
            @if (Model.NotFilteredItems.Any())
            {
                <div class="available-items">
                    @foreach (var group in notFilteredItemsGroups)
                    {
                        var groupList = group.ToList();
                        <div class="col-12 px-0">
                            <ul class="group product-spec-group">
                                <li class="title">
                                    <span>
                                        @groupList[0].SpecificationAttributeName:
                                    </span>
                                </li>
                                <li>
                                    <div class="btn-group-sm d-inline-flex flex-wrap">
                                        @foreach (var spec in groupList)
                                        {

                                            @if (String.IsNullOrEmpty(spec.SpecificationAttributeOptionColorRgb))
                                            {
                                                <a class="p-0 mr-3 border-0 spec-link" href="@spec.FilterUrl">
                                                    @spec.SpecificationAttributeOptionName
                                                </a>
                                            }
                                            else
                                            {
                                                <a class="p-0 border-0 mb-0" href="@spec.FilterUrl">
                                                    <div class="color-squares">
                                                        <span class="color-container" title="@spec.SpecificationAttributeOptionName">
                                                            <span class="color" style="background-color: @(spec.SpecificationAttributeOptionColorRgb);">&nbsp;</span>
                                                        </span>
                                                    </div>
                                                </a>
                                            }

                                        }
                                    </div>
                                </li>
                            </ul>
                        </div>
                    }
                </div>
            }
        </div>
        @if (Model.AlreadyFilteredItems.Any())
        {
            <div class="filtered-items">
                <ul class="pl-0">
                    <li class="title">
                        @T("Filtering.SpecificationFilter.CurrentlyFilteredBy")
                    </li>
                    @foreach (var attrName in Model.AlreadyFilteredItems.GroupBy(x => x.SpecificationAttributeName))
                    {

                        <li class="item pb-2">
                            <div class="pb-2"><strong>@(attrName.Key):</strong></div>
                            <div class="grid">
                                @foreach (var item in attrName)
                                {
                                    <div class="d-inline-flex flex-wrap align-items-center w-100">
                                        @if (String.IsNullOrEmpty(item.SpecificationAttributeOptionColorRgb))
                                        {
                                            <label class="custom-control custom-checkbox">
                                                <input type="checkbox" class="custom-control-input" data-href="@item.FilterUrl" onclick="window.location.replace($(this).data('href'));" checked>
                                                <span class="custom-control-label"></span>
                                                <span class="custom-control-description">@item.SpecificationAttributeOptionName</span>
                                            </label>
                                        }
                                        else
                                        {
                                            <label class="custom-control custom-checkbox">
                                                <input type="checkbox" class="custom-control-input" data-href="@item.FilterUrl" onclick="window.location.replace($(this).data('href'));" checked>
                                                <span class="custom-control-label"></span>
                                                <span class="custom-control-description"><span class="color-container" style="background-color:@(item.SpecificationAttributeOptionColorRgb);"></span></span>
                                            </label>
                                        }
                                    </div>
                                }
                            </div>
                        </li>
                    }
                </ul>
                <div class="remove-filter mb-1">
                    <a class="btn btn-outline-secondary btn-sm" href="@Model.RemoveFilterUrl">@T("Filtering.SpecificationFilter.Remove")</a>
                </div>
            </div>
        }
    </div>
}